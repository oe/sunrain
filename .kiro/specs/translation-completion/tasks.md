# 翻译完整性修复实施计划

## 实施任务

- [ ] 1. 检测和修复SSG翻译缺失问题
  - 检查现有SSG翻译文件的完整性
  - 识别缺失的翻译键和未翻译的内容
  - 补全所有支持语言的缺失翻译
  - _需求: 1.1, 1.3, 2.1, 2.2_

- [x] 1.1 创建翻译完整性检测脚本
  - 实现 `packages/website/scripts/check-translations.js`
  - 扫描 `packages/website/src/locales` 目录下的所有翻译文件
  - 以英文翻译为基准，检测其他语言缺失的翻译键
  - 识别未翻译的内容（与默认语言相同的文本）
  - 生成详细的缺失翻译报告（JSON和可读格式）
  - 支持命令行参数指定检查的语言和模块
  - _需求: 1.1, 1.2, 2.1_

- [x] 1.2 补全缺失的SSG翻译
  - 基于检测报告，为所有支持的语言补全缺失的翻译键
  - 重点关注assessment、shared、home、guide、resources、about模块
  - 确保心理健康专业术语的准确性和一致性
  - 考虑文化差异和本地化需求
  - _需求: 1.1, 1.3, 2.1, 2.2, 2.3_

- [x] 1.3 验证SSG翻译质量
  - 对补全后的翻译进行质量检查
  - 确保专业术语在不同语言中的一致性
  - 测试不同语言环境下的用户体验
  - _需求: 2.1, 2.2_

- [ ] 2. 创建CSR翻译系统
  - 为客户端组件创建独立的翻译系统
  - 从现有SSG翻译中提取客户端相关内容
  - 确保CSR翻译的完整性
  - _需求: 4.1, 4.2, 6.1, 6.2_

- [ ] 2.1 创建CSR翻译类型定义
  - 在 `packages/website/src/client-locales/shared/types.ts` 中定义CSR翻译接口
  - 创建客户端特定的翻译结构（client、interactive、actions等）
  - 确保与现有SSG类型的兼容性
  - _需求: 4.1, 4.3_

- [ ] 2.2 分析并创建assessment模块的CSR翻译
  - 检查assessment模块中的客户端组件翻译需求
  - 在 `packages/website/src/client-locales/assessment/` 创建目录结构
  - 从SSG翻译中提取客户端相关内容（client、errors、loading、actions等）
  - 为所有支持的语言创建对应的CSR翻译文件
  - _需求: 4.1, 4.2, 6.1_

- [ ] 2.3 创建CSR翻译管理器
  - 创建 `packages/website/src/utils/csr-translation-manager.ts`
  - 实现客户端动态翻译加载（从client-locales目录）
  - 添加预加载和智能缓存机制
  - 实现语言切换和状态管理
  - _需求: 3.1, 5.1, 5.3_

- [ ] 2.4 优化现有的useTranslations Hook
  - 修改 `packages/website/src/hooks/useTranslations.ts` 支持CSR翻译加载
  - 保持向后兼容性，不影响现有功能
  - 优化性能和内存使用
  - 添加更好的错误处理
  - _需求: 5.1, 5.4_

- [ ] 3. 创建翻译管理CLI工具
  - 创建命令行工具用于翻译检测、同步和维护
  - 实现SSG翻译完整性检查功能
  - 提供SSG到CSR翻译同步功能
  - _需求: 3.1, 3.2, 3.4_

- [ ] 3.1 创建CLI工具框架
  - 实现 `packages/website/src/scripts/translation-cli.ts`
  - 使用Commander.js创建命令行界面
  - 添加版本信息和帮助文档
  - _需求: 3.1_

- [ ] 3.2 实现validate命令
  - 创建SSG翻译验证命令
  - 检测所有SSG翻译文件的完整性
  - 生成详细的缺失翻译报告
  - 支持按语言和模块的统计信息
  - _需求: 3.2, 3.4_

- [ ] 3.3 实现sync命令
  - 创建SSG到CSR翻译同步命令
  - 从SSG翻译中提取客户端内容并生成CSR翻译文件
  - 支持指定源目录、目标目录和命名空间
  - 添加进度显示和错误处理
  - _需求: 3.2, 3.3_

- [ ] 3.4 实现generate命令
  - 创建缺失翻译文件生成命令
  - 支持为SSG翻译批量生成缺失的语言文件
  - 添加翻译模板生成功能
  - _需求: 3.1, 3.4_

- [ ] 4. 实现翻译同步和生成工具
  - 创建SSG到CSR翻译的自动同步机制
  - 实现智能的客户端内容检测
  - 确保翻译内容的一致性
  - _需求: 3.3, 4.5, 6.1, 6.2_

- [ ] 4.1 实现翻译同步管理器
  - 创建 `packages/website/src/utils/translation-sync-manager.ts`
  - 实现从SSG翻译提取客户端内容的逻辑
  - 添加智能检测机制，只为需要的模块创建CSR翻译
  - 实现文件生成和目录管理
  - _需求: 3.3, 4.5_

- [ ] 4.2 创建客户端内容检测器
  - 实现检测翻译文件中是否包含客户端内容的逻辑
  - 定义客户端内容的识别规则和关键词（client、errors、loading、actions等）
  - 添加递归检查嵌套对象的功能
  - _需求: 4.5, 6.1_

- [ ] 4.3 实现翻译文件生成器
  - 创建CSR翻译文件的自动生成逻辑
  - 添加文件头注释和导出格式标准化
  - 实现目录结构的自动创建
  - _需求: 4.5, 6.2_

- [ ] 5. 开发翻译管理CLI工具
  - 创建命令行工具用于翻译管理和维护
  - 实现同步、验证和生成功能
  - 提供友好的用户界面和错误提示
  - _需求: 3.1, 3.2, 3.4_

- [ ] 5.1 创建CLI工具框架
  - 实现 `packages/website/src/scripts/translation-cli.ts`
  - 使用Commander.js创建命令行界面
  - 添加版本信息和帮助文档
  - _需求: 3.1_

- [ ] 5.2 实现sync命令
  - 创建翻译同步命令
  - 支持指定源目录、目标目录和命名空间
  - 添加进度显示和错误处理
  - _需求: 3.2, 3.3_

- [ ] 5.3 实现validate命令
  - 创建翻译验证命令
  - 支持生成详细的验证报告
  - 添加按语言和模块的统计信息
  - _需求: 3.2, 3.4_

- [ ] 5.4 实现generate命令
  - 创建缺失翻译文件生成命令
  - 支持批量生成多语言文件
  - 添加模板生成功能
  - _需求: 3.1, 3.4_

- [ ] 6. 创建client-locales目录结构
  - 为需要客户端翻译的模块创建对应的目录结构
  - 从现有SSG翻译中提取客户端内容
  - 确保文件结构的一致性
  - _需求: 4.1, 4.2, 6.1_

- [ ] 6.1 分析现有翻译文件的客户端内容
  - 检查assessment模块的客户端翻译需求
  - 识别shared模块中的客户端组件翻译
  - 确定其他模块是否需要客户端翻译
  - _需求: 4.2, 6.1_

- [ ] 6.2 创建assessment模块的client-locales
  - 在 `packages/website/src/client-locales/assessment/` 创建目录结构
  - 从SSG翻译中提取客户端相关内容
  - 为所有支持的语言创建对应的翻译文件
  - _需求: 4.1, 4.2, 6.1_

- [ ] 6.3 创建shared模块的client-locales（如果需要）
  - 检查shared模块是否包含客户端组件
  - 如果需要，创建对应的客户端翻译文件
  - 确保与assessment模块的一致性
  - _需求: 4.1, 4.2_

- [ ] 7. 修复现有翻译缺失问题
  - 补全所有语言的缺失翻译
  - 提升翻译质量和文化适应性
  - 确保专业术语的一致性
  - _需求: 1.1, 1.3, 2.1, 2.2, 2.3_

- [ ] 7.1 检测和修复缺失的翻译键
  - 运行翻译验证工具识别缺失的翻译
  - 为所有支持的语言补全缺失的翻译键
  - 确保翻译的准确性和专业性
  - _需求: 1.1, 1.3_

- [ ] 7.2 优化心理健康专业术语翻译
  - 审查和改进心理健康相关术语的翻译
  - 确保不同语言中专业术语的一致性
  - 考虑文化差异和本地化需求
  - _需求: 2.1, 2.2, 2.3_

- [ ] 7.3 验证和测试翻译质量
  - 对所有翻译进行质量检查
  - 测试不同语言环境下的用户体验
  - 修复发现的翻译问题
  - _需求: 2.1, 2.2_

- [ ] 8. 更新翻译加载机制
  - 修改现有的翻译加载逻辑以支持新的架构
  - 确保SSG和CSR翻译的正确加载
  - 优化性能和缓存策略
  - _需求: 5.1, 5.2, 5.3, 6.3, 6.4_

- [ ] 8.1 更新服务端翻译加载逻辑
  - 修改Astro页面中的翻译加载方式
  - 确保使用正确的SSG翻译管理器
  - 保持现有功能的兼容性
  - _需求: 5.1, 6.3_

- [ ] 8.2 优化客户端翻译加载性能
  - 实现翻译文件的懒加载和预加载
  - 优化缓存策略和内存使用
  - 添加加载状态和错误处理
  - _需求: 5.2, 5.3, 5.4_

- [ ] 8.3 实现语言切换的无缝体验
  - 确保SSG和CSR组件间的语言状态同步
  - 优化语言切换的性能和用户体验
  - 添加语言切换的过渡效果
  - _需求: 5.4, 6.4_

- [ ] 9. 添加错误处理和监控
  - 实现全面的翻译错误处理机制
  - 添加翻译加载失败的监控和报告
  - 提供友好的用户错误提示
  - _需求: 5.2, 5.3_

- [ ] 9.1 创建翻译错误处理器
  - 实现 `packages/website/src/utils/translation-error-handler.ts`
  - 添加不同类型错误的处理逻辑
  - 实现错误报告和监控功能
  - _需求: 5.2_

- [ ] 9.2 添加翻译加载状态管理
  - 在翻译管理器中添加加载状态跟踪
  - 实现加载失败的重试机制
  - 添加用户友好的错误提示
  - _需求: 5.2, 5.3_

- [ ] 9.3 实现翻译缺失的运行时检测
  - 在生产环境中检测和记录缺失的翻译
  - 实现本地存储的缺失翻译收集
  - 提供开发者工具用于调试翻译问题
  - _需求: 5.2_

- [ ] 10. 创建测试套件
  - 为翻译系统创建全面的测试覆盖
  - 确保翻译功能的稳定性和可靠性
  - 添加自动化测试到CI/CD流程
  - _需求: 1.4, 2.4, 3.4_

- [ ] 10.1 创建翻译管理器单元测试
  - 为SSG和CSR翻译管理器编写单元测试
  - 测试翻译加载、缓存和错误处理逻辑
  - 确保边界情况的正确处理
  - _需求: 1.4, 2.4_

- [ ] 10.2 创建翻译验证器测试
  - 为翻译验证器编写全面的测试用例
  - 测试各种翻译错误和警告的检测
  - 验证报告生成的准确性
  - _需求: 1.4, 2.4_

- [ ] 10.3 创建端到端翻译测试
  - 测试完整的翻译工作流程
  - 验证多语言用户界面的正确性
  - 测试语言切换和状态同步
  - _需求: 3.4_

- [ ] 11. 文档和维护指南
  - 创建翻译系统的使用文档
  - 编写维护和更新指南
  - 提供最佳实践和故障排除指南
  - _需求: 3.4_

- [ ] 11.1 编写翻译系统使用文档
  - 创建开发者使用指南
  - 文档化CLI工具的使用方法
  - 提供翻译文件结构和类型的说明
  - _需求: 3.4_

- [ ] 11.2 创建翻译维护指南
  - 编写翻译更新和同步的流程文档
  - 提供翻译质量检查的最佳实践
  - 创建故障排除和调试指南
  - _需求: 3.4_

- [ ] 11.3 建立翻译贡献流程
  - 创建社区翻译贡献的指南
  - 建立翻译审核和质量控制流程
  - 提供翻译工具和资源的使用说明
  - _需求: 3.4_
